<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Memory Match Â· Gaming Under The Trees</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg: #0b0f14;
      --panel: #111720;
      --border: #1f2a37;
      --muted: #93a1b1;
      --text: #e6edf3;
      --accent: #6ee7b7;
      --accent-2: #60a5fa;
      --ring: rgba(110, 231, 183, .35);
    }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, Noto Sans, Helvetica Neue, Arial;
      background: radial-gradient(1200px 600px at 20% -10%, rgba(96,165,250,.15), transparent 60%),
                  radial-gradient(1000px 500px at 120% 10%, rgba(110,231,183,.12), transparent 60%),
                  var(--bg);
      color: var(--text);
    }
    .container { max-width: 960px; margin: 0 auto; padding: 24px; }
    header { display:flex; align-items:center; justify-content:space-between; gap: 12px; margin-bottom: 10px; }
    .brand { display:flex; align-items:center; gap:10px; text-decoration:none; color:var(--text); font-weight:700; }
    .logo { width: 30px; height: 30px; border-radius: 8px; background: conic-gradient(from 210deg, var(--accent), var(--accent-2)); box-shadow: 0 0 0 5px rgba(110,231,183,.08); }
    .btn { cursor:pointer; border:1px solid var(--border); background:#0e141c; color:var(--text); padding:9px 12px; border-radius:10px; font-weight:600; }
    .btn.primary { background: linear-gradient(135deg, var(--accent), var(--accent-2)); color:#061018; border:0; box-shadow: 0 0 0 6px var(--ring); }

    .panel { background: linear-gradient(180deg, rgba(17,23,32,.9), rgba(17,23,32,.6)); border: 1px solid var(--border); border-radius: 16px; padding: 16px; }
    .hud { display:flex; flex-wrap:wrap; align-items:center; gap:10px; justify-content: space-between; margin: 12px 0 18px; }
    .stat { color: var(--muted); }
    .stat strong { color: var(--text); }

    .board { display: grid; grid-template-columns: repeat(4, 1fr); gap: 12px; }
    .card {
      position: relative; aspect-ratio: 1 / 1; border: 1px solid var(--border); border-radius: 14px; overflow: hidden;
      transform-style: preserve-3d; transition: transform .4s ease;
      background: #0f1622;
    }
    .card:focus { outline: none; box-shadow: 0 0 0 4px var(--ring); }
    .card-inner { position:absolute; inset:0; transform-style: preserve-3d; transition: transform .5s ease; }
    .card.is-flipped .card-inner, .card.is-matched .card-inner { transform: rotateY(180deg); }

    .face {
      position:absolute; inset:0; display:grid; place-items:center; font-size: 34px; backface-visibility:hidden;
    }
    .front { background: linear-gradient(180deg, rgba(17,23,32,.95), rgba(17,23,32,.7)); }
    .back { transform: rotateY(180deg); background: radial-gradient(180px 180px at 50% 40%, rgba(96,165,250,.2), transparent 60%),
                                   radial-gradient(220px 180px at 30% 70%, rgba(110,231,183,.2), transparent 65%), #0c121b; }

    .toolbar { display:flex; gap:10px; }
    .grid-select { border: 1px solid var(--border); background:#0e141c; color:var(--text); padding:9px 12px; border-radius:10px; }

    .sr-only { position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

    footer { color:#7b8a9a; text-align:center; margin: 26px 0 10px; }
    @media (max-width: 640px) { .board { grid-template-columns: repeat(4, 1fr); } }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <a class="brand" href="./home.html" aria-label="Back to Home">
        <div class="logo" aria-hidden="true"></div>
        <div>Gaming Under The Trees</div>
      </a>
      <div class="toolbar">
        <select id="size" class="grid-select" aria-label="Board size">
          <option value="4">4x4</option>
          <option value="6">6x6</option>
        </select>
        <button id="restart" class="btn">Restart</button>
      </div>
    </header>

    <div class="panel hud" role="region" aria-label="Game heads up display">
      <div class="stat">Moves: <strong id="moves">0</strong></div>
      <div class="stat">Matches: <strong id="matches">0</strong>/<span id="total">8</span></div>
      <div class="stat">Time: <strong id="time">0:00</strong></div>
    </div>

    <div id="board" class="board" role="grid" aria-label="Memory board"></div>

    <footer>
      Tip: Use Tab/Enter or click to flip. Match all pairs to win.
    </footer>
  </div>

  <template id="card-template">
    <button class="card" role="gridcell" aria-live="polite" aria-pressed="false">
      <span class="sr-only">Card</span>
      <div class="card-inner">
        <div class="face front">ðŸŒ¿</div>
        <div class="face back" data-symbol>?</div>
      </div>
    </button>
  </template>

  <script>
    (function() {
      const symbolsBase = ['ðŸƒ','ðŸŒ™','â­','ðŸŒ¸','ðŸ‚','ðŸ”¥','ðŸ’§','ðŸŒˆ','ðŸŒ¼','ðŸª','â„ï¸','ðŸª½','ðŸŒŠ','ðŸŒµ','ðŸ€','ðŸŒŸ','ðŸŒ»','ðŸŒ™'];
      const boardEl = document.getElementById('board');
      const movesEl = document.getElementById('moves');
      const matchesEl = document.getElementById('matches');
      const totalEl = document.getElementById('total');
      const timeEl = document.getElementById('time');
      const restartBtn = document.getElementById('restart');
      const sizeSelect = document.getElementById('size');
      const tpl = document.getElementById('card-template');

      let first = null; // first selected card element
      let second = null; // second selected card element
      let lock = false; // to prevent clicks while checking
      let moves = 0;
      let matches = 0;
      let totalPairs = 8;
      let timer = null;
      let seconds = 0;

      function startTimer() {
        stopTimer();
        seconds = 0;
        timeEl.textContent = formatTime(seconds);
        timer = setInterval(() => {
          seconds += 1;
          timeEl.textContent = formatTime(seconds);
        }, 1000);
      }
      function stopTimer() { if (timer) { clearInterval(timer); timer = null; } }
      function formatTime(s) {
        const m = Math.floor(s/60);
        const r = s % 60;
        return m + ':' + (r < 10 ? '0'+r : r);
      }

      function shuffle(array) {
        for (let i = array.length - 1; i > 0; i--) {
          const j = Math.floor(Math.random() * (i + 1));
          [array[i], array[j]] = [array[j], array[i]];
        }
        return array;
      }

      function setup(size=4) {
        // compute pairs
        const cells = size * size;
        totalPairs = cells / 2;
        totalEl.textContent = totalPairs;
        moves = 0; matches = 0;
        movesEl.textContent = '0';
        matchesEl.textContent = '0';
        first = second = null; lock = false;

        // build deck
        const needed = totalPairs;
        const chosen = symbolsBase.slice(0, needed);
        const deck = shuffle([...chosen, ...chosen]);

        // build DOM
        boardEl.innerHTML = '';
        boardEl.style.gridTemplateColumns = `repeat(${size}, 1fr)`;
        deck.forEach((sym, idx) => {
          const node = tpl.content.firstElementChild.cloneNode(true);
          const back = node.querySelector('[data-symbol]');
          back.textContent = sym;
          node.dataset.symbol = sym;
          node.dataset.index = String(idx);
          node.addEventListener('click', () => flip(node));
          node.addEventListener('keydown', (e) => { if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); flip(node); } });
          boardEl.appendChild(node);
        });
        startTimer();
      }

      function flip(card) {
        if (lock) return;
        if (card.classList.contains('is-matched')) return;
        if (card === first) return;

        card.classList.add('is-flipped');
        card.setAttribute('aria-pressed', 'true');
        if (!first) {
          first = card; return;
        }
        second = card;
        lock = true;
        moves += 1; movesEl.textContent = String(moves);

        const isMatch = first.dataset.symbol === second.dataset.symbol;
        setTimeout(() => {
          if (isMatch) {
            first.classList.add('is-matched');
            second.classList.add('is-matched');
            first.setAttribute('aria-label', `Matched ${first.dataset.symbol}`);
            second.setAttribute('aria-label', `Matched ${second.dataset.symbol}`);
            matches += 1; matchesEl.textContent = String(matches);
            if (matches === totalPairs) {
              stopTimer();
              setTimeout(() => {
                alert(`You won! Moves: ${moves}, Time: ${timeEl.textContent}`);
              }, 50);
            }
          } else {
            first.classList.remove('is-flipped');
            second.classList.remove('is-flipped');
            first.setAttribute('aria-pressed', 'false');
            second.setAttribute('aria-pressed', 'false');
          }
          first = second = null;
          lock = false;
        }, 650);
      }

      restartBtn.addEventListener('click', () => setup(parseInt(sizeSelect.value, 10)));
      sizeSelect.addEventListener('change', () => setup(parseInt(sizeSelect.value, 10)));

      // init
      setup(4);
    })();
  </script>
</body>
</html>
